<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Predicting Stock Change With Python | Data Science Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Predicting Stock Change With Python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This site is built with fastpages." />
<meta property="og:description" content="This site is built with fastpages." />
<link rel="canonical" href="https://christopherguan.github.io/sample-ds-blog/fastpages/jupyter/python/selenium/stoc/2022/02/23/Sl.html" />
<meta property="og:url" content="https://christopherguan.github.io/sample-ds-blog/fastpages/jupyter/python/selenium/stoc/2022/02/23/Sl.html" />
<meta property="og:site_name" content="Data Science Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-23T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Predicting Stock Change With Python" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-23T00:00:00-06:00","datePublished":"2022-02-23T00:00:00-06:00","description":"This site is built with fastpages.","headline":"Predicting Stock Change With Python","mainEntityOfPage":{"@type":"WebPage","@id":"https://christopherguan.github.io/sample-ds-blog/fastpages/jupyter/python/selenium/stoc/2022/02/23/Sl.html"},"url":"https://christopherguan.github.io/sample-ds-blog/fastpages/jupyter/python/selenium/stoc/2022/02/23/Sl.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/sample-ds-blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://christopherguan.github.io/sample-ds-blog/feed.xml" title="Data Science Blog" /><link rel="shortcut icon" type="image/x-icon" href="/sample-ds-blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" /><script src="https://hypothes.is/embed.js" async></script>

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/sample-ds-blog/">Data Science Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/sample-ds-blog/about/">About Chris</a><a class="page-link" href="/sample-ds-blog/search/">Search</a><a class="page-link" href="/sample-ds-blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Predicting Stock Change With Python</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-02-23T00:00:00-06:00" itemprop="datePublished">
        Feb 23, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/sample-ds-blog/categories/#Fastpages">Fastpages</a>
        &nbsp;
      
        <a class="category-tags-link" href="/sample-ds-blog/categories/#Jupyter">Jupyter</a>
        &nbsp;
      
        <a class="category-tags-link" href="/sample-ds-blog/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/sample-ds-blog/categories/#Selenium">Selenium</a>
        &nbsp;
      
        <a class="category-tags-link" href="/sample-ds-blog/categories/#Stoc">Stoc</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/christopherGuan/sample-ds-blog/tree/master/_notebooks/2022-02-23-Sl.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/sample-ds-blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/christopherGuan/sample-ds-blog/master?filepath=_notebooks%2F2022-02-23-Sl.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/sample-ds-blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/christopherGuan/sample-ds-blog/blob/master/_notebooks/2022-02-23-Sl.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/sample-ds-blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FchristopherGuan%2Fsample-ds-blog%2Fblob%2Fmaster%2F_notebooks%2F2022-02-23-Sl.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/sample-ds-blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Set-up-the-envirnment">Set up the envirnment </a></li>
<li class="toc-entry toc-h2"><a href="#Do-not-have-enough-stock-data?">Do not have enough stock data? </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Method-one:-scrapying-the-stock-data-from-Yahoo-for-free!">Method one: scrapying the stock data from Yahoo for free! </a></li>
<li class="toc-entry toc-h3"><a href="#Method-two:-applying-historical-stock-data-from-IEX-Cloud-with-cost.">Method two: applying historical stock data from IEX Cloud with cost. </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Predict-the-future-stock!">Predict the future stock! </a></li>
<li class="toc-entry toc-h2"><a href="#Magic-that-send-message-through-gmail!">Magic that send message through gmail! </a></li>
<li class="toc-entry toc-h2"><a href="#Conclusion">Conclusion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-02-23-Sl.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Stock is a highly sensitive and turbulent market. Because of the recent crisis between Russia and Ukraine, for example, a few comments from Putin or another powerful figure might lead millions of people to lose or make profit in a matter of minutes. A essential skill that modern people should have is the ability to foresee trends in order to preserve their investments and maximize their profits. In this blog, we are going to introduce three basic functions to support you to achieve the following goals.</p>
<p>First, <a href="https://pypi.org/project/selenium/">selenium</a> is the first option to support us to do web scraping from <a href="https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&amp;count=202">Yahoo finance</a> based on the filter we set up, such as Aggressive Small Caps. Here is a <a href="https://www.youtube.com/watch?v=Xjv1sY630Uc">Youtube selenium tutoria</a> that I recommend you to  set up selenium. And use this selenium python tutorial as more detailed reference. Then, we will get the historical data of that most active stock. Second, we will predict the stock trends. Eventually, we send out the predictions and the lastest change on the stock to our receiver by email.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://miro.medium.com/max/1400/0*oWZiknkZ2GzGBkIJ" alt="Stock Image"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Set-up-the-envirnment">
<a class="anchor" href="#Set-up-the-envirnment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Set up the envirnment<a class="anchor-link" href="#Set-up-the-envirnment"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Bleow are some packages that are necessary to run the code.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">getpass</span> <span class="kn">import</span> <span class="n">getpass</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">timezone</span>
<span class="kn">import</span> <span class="nn">smtplib</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1">#For Prediction</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>

<span class="c1">#For Stock Data</span>
<span class="kn">from</span> <span class="nn">iexfinance.stocks</span> <span class="kn">import</span> <span class="n">get_historical_data</span>
<span class="kn">from</span> <span class="nn">iexfinance.stocks</span> <span class="kn">import</span> <span class="n">Stock</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Do-not-have-enough-stock-data?">
<a class="anchor" href="#Do-not-have-enough-stock-data?" aria-hidden="true"><span class="octicon octicon-link"></span></a>Do not have enough stock data?<a class="anchor-link" href="#Do-not-have-enough-stock-data?"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Method-one:-scrapying-the-stock-data-from-Yahoo-for-free!">
<a class="anchor" href="#Method-one:-scrapying-the-stock-data-from-Yahoo-for-free!" aria-hidden="true"><span class="octicon octicon-link"></span></a>Method one: scrapying the stock data from Yahoo for free!<a class="anchor-link" href="#Method-one:-scrapying-the-stock-data-from-Yahoo-for-free!"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After following the tutorial at the very beginning of this blog, we can create our chrome drive and use driver.get(url) navigate to our desired webpage: <a href="https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&amp;count=202">Yahoo finance</a> which displays the top 25 most active stocks by default. You can also change the filter based on what you are looking for. Inside webdriver.Chrome() you will need to type your chromedriver path.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After connecting to Yahoo by using webdriver, we could use a double for loops to crawl the whole database on the website. In detail, "j" represents how many rows we need, and "i" represents which column we need.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">getStocks</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="c1">#Navigating to the Yahoo stock screener</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span> <span class="n">Service</span><span class="p">(</span>
        <span class="s1">'/Users/zeyu/Desktop/chromedriver'</span><span class="p">))</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">"https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&amp;count=202"</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="c1">#Creating a stock list and iterating through the ticker names on the stock screener list</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ticker</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                <span class="s1">'//*[@id = "scr-res-table"]/div[1]/table/tbody/tr['</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">']/td['</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">']'</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>  
    <span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

    <span class="c1">#Using the stock list to predict the future price of the stock a specificed amount of days</span>
    <span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Number: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">predictData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Stock: "</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s2">" was not predicted"</span><span class="p">)</span>
        <span class="n">number</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">getStocks</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Method-two:-applying-historical-stock-data-from-IEX-Cloud-with-cost.">
<a class="anchor" href="#Method-two:-applying-historical-stock-data-from-IEX-Cloud-with-cost." aria-hidden="true"><span class="octicon octicon-link"></span></a>Method two: applying historical stock data from IEX Cloud with cost.<a class="anchor-link" href="#Method-two:-applying-historical-stock-data-from-IEX-Cloud-with-cost."> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before everything, you need to visit <a href="https://iexcloud.io/">iexcloud</a> to create an account and get a exclusive API. The free version only offers a very limited access.</p>
<p>Now, we can using the get_historical_data() package to get cleaned up dataset you want. Then there are a few parameters you need to enter. First, you need to enter the stock symblo like (AAPL). Then, set the start and end date, the output format (we will use pandas in this project), and eventually, the token which is API you acquired from the iexcloud website.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">API</span> <span class="o">=</span> <span class="n">getpass</span><span class="p">(</span><span class="s2">"Please enter your API"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">get_historical_data</span><span class="p">(</span><span class="n">stock_symblo</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">'pandas'</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">API</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Predict-the-future-stock!">
<a class="anchor" href="#Predict-the-future-stock!" aria-hidden="true"><span class="octicon octicon-link"></span></a>Predict the future stock!<a class="anchor-link" href="#Predict-the-future-stock!"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the following lines, we first create a prediction column called "Prediction", each day's close price is the prediction of the previous day. Second, two datasets are created. X is the predictor variable, Y is the target variable. Preprocessing package is to nomalize our predictor variables. Then we split our data into train and test datasets for both X and Y. Then we use the Regression on the training data, then predict the closing price of X_prediction.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">predictData</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">days</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">'./Exports'</span><span class="p">):</span>
        <span class="n">csv_name</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Exports/'</span> <span class="o">+</span> <span class="n">stock</span> <span class="o">+</span> <span class="s1">'_Export.csv'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">"Exports"</span><span class="p">)</span>
        <span class="n">csv_name</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Exports/'</span> <span class="o">+</span> <span class="n">stock</span> <span class="o">+</span> <span class="s1">'_Export.csv'</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_name</span><span class="p">)</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'close'</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">forecast_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>

    <span class="c1">#Predicting the Stock price in the future</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'prediction'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">])</span>

    <span class="c1">#Nomalize our predictor variables</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">X aftre preprocessing:"</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">X_prediction</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="n">forecast_time</span><span class="p">:]</span>
    
    <span class="c1"># Split our data into train and test data</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_Test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">X train:"</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">X_test:"</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Y_train:"</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Y_Test"</span><span class="p">,</span> <span class="n">Y_Test</span><span class="p">)</span>

    <span class="c1">#Performing the Regression on the training data</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

    <span class="c1">#Predict the closing price of X_prediction.</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_prediction</span><span class="p">))</span>

    <span class="n">last_row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Last row:"</span><span class="p">,</span> <span class="n">last_row</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Last row 1:"</span><span class="p">,</span> <span class="n">last_row</span><span class="p">[</span><span class="s1">'close'</span><span class="p">])</span>

    <span class="c1">#Sending the SMS if the predicted price of the stock is at least 1 greater than the previous closing price</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">last_row</span><span class="p">[</span><span class="s1">'close'</span><span class="p">]))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">Stock:"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stock</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Prior Close:</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">last_row</span><span class="p">[</span><span class="s1">'close'</span><span class="p">])</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">Prediction in 1 Day: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Prediction in 5 Days: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="c1">#sendMessage(output)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"This is the output:"</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

<span class="n">predictData</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Magic-that-send-message-through-gmail!">
<a class="anchor" href="#Magic-that-send-message-through-gmail!" aria-hidden="true"><span class="octicon octicon-link"></span></a>Magic that send message through gmail!<a class="anchor-link" href="#Magic-that-send-message-through-gmail!"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Eventually, the last function sendMessage(text) is for us to send messages through gamil when some conditions are triggered by using <a href="https://docs.python.org/3/library/smtplib.html">smtplib</a> module. getpass() is another package use here for user enter the password to improve the security.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="c1"># If you're using Gmail to send the message, you might need to </span>
    <span class="c1"># go into the security settings of your email account and </span>
    <span class="c1"># enable the "Allow less secure apps" option </span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">getpass</span><span class="p">(</span><span class="s2">"Please enter your gmail address like chrisguan912@gmail.com"</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">getpass</span><span class="p">(</span><span class="s2">"Please enter your password"</span><span class="p">)</span>

    <span class="n">vtext</span> <span class="o">=</span> <span class="n">getpass</span><span class="p">(</span><span class="s2">"Please enter the receiver's phone number and company's domain like 9292649156@txt.att.net"</span><span class="p">)</span>
   
    <span class="n">message</span> <span class="o">=</span> <span class="n">getpass</span><span class="p">(</span><span class="s2">"Please enter your message"</span><span class="p">)</span>

    <span class="n">MSG</span> <span class="o">=</span> <span class="s2">"""From: </span><span class="si">%s</span><span class="s2">  </span><span class="se">\n</span><span class="s2"> </span>
<span class="s2">    To:      </span><span class="si">%s</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">    </span><span class="si">%s</span><span class="s2"> """</span> <span class="o">%</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">vtext</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

    <span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="s1">'smtp.gmail.com'</span><span class="p">,</span> <span class="mi">587</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
    <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">vtext</span><span class="p">,</span> <span class="n">MSG</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'Sent'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h2>
<p>The blog introduced four functions in total. The first two can support us to apply valuable data by using selenium or download from iexcloud. The third funciton is to analyze the predict the stock trend. The last few lines support us to send a message through gmail.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="christopherGuan/sample-ds-blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/sample-ds-blog/fastpages/jupyter/python/selenium/stoc/2022/02/23/Sl.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/sample-ds-blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/sample-ds-blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/sample-ds-blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>This site is built with fastpages.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/christopherGuan" target="_blank" title="christopherGuan"><svg class="svg-icon grey"><use xlink:href="/sample-ds-blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/sample-ds-blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
